{% extends "base.html" %}

{% block content %}

<section class="slider">
  <ul class="slides">
    <li>
      <img class="image" src="https://images.unsplash.com/photo-1472653525502-fc569e405a74?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="">
      <div class="caption center-align">
        <h2 class="slider-text">Look for local farms</h2>
        <h5 class="light grey-text text-lighten-3 hide-on-small-only">Search your local area to find farms and produce stands near you!</h5>
        <a href="#" class="green darken-3 btn btn-large">Learn More</a>
      </div>
    </li>
    <li>
      <img class="image" src="https://images.unsplash.com/photo-1486328228599-85db4443971f?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="">
      <div class="caption left-align">
        <h2 class="slider-text">Search for produce that is grown locally</h2>
        <h5 class="light grey-text text-lighten-3 hide-on-small-only">Minimize your carbon-footprint by selecting items that are grown or harvested nearby!</h5>
        <a href="#" class="green darken-3 btn btn-large">Learn More</a>
      </div>
    </li>
    <li>
      <img class="image" src="https://images.unsplash.com/photo-1565522734001-f00e62ec8424?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="">
      <div class="caption right-align">
        <h2 class="slider-text">Connect with your community</h2>
        <h5 class="light grey-text text-lighten-3 hide-on-small-only">Gain the ability to connect with local farms to see what is available during particular seasons!</h5>
        <a href="#" class="green darken-3 btn btn-large">Learn More</a>
      </div>
    </li>
  </ul>
</section>

<section id="search" class="section section-search green darken-3 white-text center scrollspy">
  <div class="container">
    <div class="row">
      <div class="col s12">
        <h3 class="search-text">Search for Local Produce</h3>
        <div class="input-field">
          <i class="small material-icons searchbox hide-on-small-only">search</i>
          <input class="white grey-text autocomplete" placeholder="Blueberries, Kale, etc..." type="text" id="autocomplete-input">
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section section-icons grey lighten-4 center">
  <div class="container">
    <div class="row">
      <div class="col s12 m4">
        <a href="{% url 'search' %}">
        <div class="card-panel ">
          <i class="material-icons large blue-text">room</i>
          <h4 class="search-text">Search Local</h4>
          <p>Love a fruit or veggie during a particular time of year? Simply use search <i class="material-icons">search</i> to see whats available nearby!</p>
        </a>
        </div>
      </div>
      <div class="col s12 m4">
        <a href="{% url 'search' %}">
        <div class="card-panel">
          <i class="material-icons large blue-text darken-2">store</i>
          <h4 class="search-text">Buy Local</h4>
          <p><br>Get the freshest produce in the surrounding area!<br><br></p>
        </a>
        </div>
      </div>
      <div class="col s12 m4">
        <a href="{% url 'search' %}">
        <div class="card-panel">
          <i class="material-icons large blue-text">insert_emoticon</i>
          <h4 class="search-text">Support Local</h4>
          <p><br>Support local businesses and surrounding farmers to help build a stronger community.<br></p>
        </a>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="popular" class="section section-popular scrollspy">
  <div class="container">
    <div class="row">
      <h4 class="center">
        <span class="green-text">Nearby</span> Farms</h4>
      <div class="col s12 m8">
        <div class="card">
           <div class='row' id='ma'>
            
            <div class="">
              <div class='sidebar pad2' style='height:280px;'>
                
                  
                <div class='center-align caption hero  z-depth-5'>
                  <img src="" alt="">
                  <div class="">
                  <h6 class='listItems'>Yours Locally:</h6>
                  <ul class='listItems'>
                    {% for farm in farms.all %}
                    <li><a href='{{farm.name}}'>{{ farm.name }}</a></li>
                    {% endfor %}
                  </ul>
                  </div>
                  <div class='caption center'>
                  <div id='listings' class='listings '>
                  
                </div>
                </div>
                </div>
                
                
              </div>
                    
                    <div id="map" class='map pad2' style='height:280px;'>Map</div>
                    <script>
                    mapboxgl.accessToken = 'pk.eyJ1IjoiaGRkbCIsImEiOiJja2NtMGY1ZDgwcTZ5MnN0OGY3ajJjbW4yIn0.qHA8T449zRKiEj4SS9jnuQ';
                    var map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: [-78.9013, 35.9958],           
                    zoom: 11
                    });
                    map.addControl(
                      new MapboxGeocoder({
                      accessToken: mapboxgl.accessToken,
                      mapboxgl: mapboxgl
                      })
                      );
                    var marker = new mapboxgl.Marker()
                      .setLngLat([-78.9013, 35.9958])
                      .addTo(map);
                      map.addControl(
                    new mapboxgl.GeolocateControl({
                      positionOptions: {
                      enableHighAccuracy: true
                      },
                      trackUserLocation: true
                      })
                      );
                    //   stores.features.forEach(function(store, i){
                    //   store.properties.id = i;
                    // });
                    map.on('load', function() {
            // Add an image to use as a custom marker
                       map.loadImage(
                      'https://docs.mapbox.com/mapbox-gl-js/assets/custom_marker.png',
                      function(error, image) {
                      if (error) throw error;
                      map.addImage('custom-marker', image);
                      // Add a GeoJSON source with 3 points.
                      map.addSource('points', {
                      'type': 'geojson',
                      'data': {
                      'type': 'FeatureCollection',
                      'features': [
                      {% for farm in farms.all %}
                      {
                      'type': 'Feature',
                      'properties': {},
                      'geometry': {
                      'type': 'Point',
                      'coordinates': [
                      {{farm.longitude}},
                      {{farm.latitude}}
                      ]
                      }
                      },{% endfor %}
                      ]
                      }
                      });
                      // Add a symbol layer
                      map.addLayer({
                      'id': 'symbols',
                      'type': 'symbol',
                      'source': 'points',
                      'layout': {
                      'icon-image': 'custom-marker'
                      }
                      });
                      }
                      );
                      
                      // Center the map on the coordinates of any clicked symbol from the 'symbols' layer.
                      map.on('click', 'symbols', function(e) {
                      map.flyTo({
                      center: e.features[0].geometry.coordinates
                      });
                      });
                      
                      // Change the cursor to a pointer when the it enters a feature in the 'symbols' layer.
                      map.on('mouseenter', 'symbols', function() {
                      map.getCanvas().style.cursor = 'pointer';
                      });
                      
                      // Change it back to a pointer when it leaves.
                      map.on('mouseleave', 'symbols', function() {
                      map.getCanvas().style.cursor = '';
                      });
                      });
                      </script> 
                    </div>
                  </div> 
                </div>
              </div>


        <div class="col s12 m4">
          <div class="card">
            <div class="card-image">
              <img src="https://images.unsplash.com/photo-1464226184884-fa280b87c399?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1050&q=80" alt="">
              <span class="card-title"><a class="waves-effect waves-light green darken-1 btn-large">{{ farm.name }}</a></span>
              <a class="btn-floating halfway-fab waves-effect waves-light red"><i class="material-icons">favorite</i></a>
            </div>
            <div class="card-content">
              <p><i class="material-icons">location_on</i>{{ farm.location }}</p>
              <p><i class="material-icons">access_time</i> {{ farm.hours }}</p>
              <p><i class="material-icons">public</i> {{ farm.website }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col s12 center">
          <a href="#contact" class="btn btn-large grey darken-3">
            <i class="material-icons left">send</i> Contact selected farm
          </a>
        </div>
      </div>
    </div>
  </section>


  

<section id="gallery" class="section section-gallery scrollspy">
  <div class="container">
    <h4 class="center">
      <span class="green-text">Photo </span> Gallery
    </h4>
    <div class="row">
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?tractor" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?blueberries" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?carrots" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?cow, chickens" alt="">
      </div>
    </div>

    <div class="row">
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?cornfield" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?fruit" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?farm" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?barn, silo" alt="">
      </div>
    </div>

    <div class="row">
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?smile" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?chickens" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?crops" alt="">
      </div>
      <div class="col s12 m3">
        <img class="materialboxed responsive-img" src="https://source.unsplash.com/1600x900/?honeybee" alt="">
      </div>
    </div>
  </div>
</section>


<section id="contact" class="section section-contact scrollspy">
  <div class="container">
    <div class="row">
      <div class="col s12 m6">
        <div class="card-panel green darken-2 white-text center">
          <i class="material-icons medium">email</i>
          <h5>Contact Us</h5>
          <p>Have a question for us? Fill out the form to let us know how we can better serve you and your community!</p>
        </div>
        <ul class="collection with-header">
          <li class="collection-header">
            <h4>Location</h4>
          </li>
          <li class="collection-item">Crop Circles</li>
          <li class="collection-item">123 Ol'Dirt rd, Suite 33</li>
          <li class="collection-item">Durham, NC 55555</li>
        </ul>
      </div>
      <div class="col s12 m6">
        <div class="card-panel grey lighten-3">
          <h5>Please fill out this form</h5>
          <div class="input-field">
            <input type="text" placeholder="Name" id="name">
            <label for="name">Name</label>
          </div>
          <div class="input-field">
            <input type="email" placeholder="Email" id="email">
            <label for="email">Email</label>
          </div>
          <div class="input-field">
            <input type="text" placeholder="Phone" id="phone">
            <label for="phone">Phone</label>
          </div>
          <div class="input-field">
            <textarea class="materialize-textarea" placeholder="Enter Message" id="message"></textarea>
            <label for="message">Message</label>
          </div>
          <input type="submit" value="Submit" class="btn green darken-1">
        </div>
      </div>
    </div>
  </div>
</section>


      <section class="section section-follow green darken-2 white-text center">
        <div class="container">
          <div class="row">
            <div class="col s12">
              <h5 class="search-text">Follow Crop Circles</h5>
              <p>Follow us on social media for special offers</p>
              <h1 target="_blank" class="white-text center">
                <i class="fab fa-facebook fa-4x"></i>
            </h1>
              <a href="htttps://twitter.com" target="_blank" class="white-text">
                <i class="fab fa-twitter fa-4x"></i>
              </a>
              <a href="htttps://linkedin.com" target="_blank" class="white-text">
                <i class="fab fa-linkedin fa-4x"></i>
              </a>
              <a href="htttps://googleplus.com" target="_blank" class="white-text">
                <i class="fab fa-google-plus fa-4x"></i>
              </a>
              <a href="htttps://pinterest.com" target="_blank" class="white-text">
                <i class="fab fa-pinterest fa-4x"></i>
              </a>
            </div>
          </div>
        </div>
      </section>

   
     <!-- <script>
    function buildLocationList(data) {
      data.features.forEach(function(store, i){
        /**
         * Create a shortcut for `store.properties`,
         * which will be used several times below.
        **/
        var prop = store.properties;
    
        /* Add a new listing section to the sidebar. */
        var listings = document.getElementById('listings');
        var listing = listings.appendChild(document.createElement('div'));
        /* Assign a unique `id` to the listing. */
        listing.id = "listing-" + prop.id;
        /* Assign the `item` class to each listing for styling. */
        listing.className = 'item';
    
        /* Add the link to the individual listing created above. */
        var link = listing.appendChild(document.createElement('a'));
        link.href = '#';
        link.className = 'title';
        link.id = "link-" + prop.id;
        link.innerHTML = prop.address;
    
        /* Add details to the individual listing. */
        var details = listing.appendChild(document.createElement('div'));
        details.innerHTML = prop.city;
        if (prop.phone) {
          details.innerHTML += ' · ' + prop.phoneFormatted;
        }
      });
    }
</script> -->
   </body>

</div>
{% endblock %}